[tool.poetry]
name = "mip-engine"
version = "0.1.0"
description = "Core engine for the Medical Informatics Platform"
authors = ["Your Name <you@example.com>"]

[tool.poetry.dependencies]
python = "~3.8"
hypercorn = "^0.14.3"
Quart = "^0.17.0"
celery = "^5.2"
asgiref = "^3.6.0"
pymonetdb = "1.6.3" # Must be updated together with mipdb Dockerfile
astor = "^0.8.1"
numpy = "1.24.1" # Must be updated together with monetdb Dockerfile
scipy = "1.10.0" # Must be updated together with monetdb Dockerfile
pandas = "1.5.2" # Must be updated together with monetdb Dockerfile
scikit-learn = "1.2.0"  # Must be updated together with monetdb Dockerfile
dnspython = "2.2.1" # TODO upgrade this when: https://github.com/eventlet/eventlet/issues/781
pydantic = "^1.10.4"
envtoml = "^0.1.2"
requests = "^2.28.2"
eventlet = "^0.33.1"

[tool.poetry.dev-dependencies]
pytest = "^7"
pytest-xdist = "^3.1.0"
pytest-asyncio="^0.20.3"
pytest-mock="^3.8.2"
pytest-assume="2.4.3"
ipython = "^8.8.0"
pdbpp = "^0.10.2"
invoke = "^2.0.0"
black = "22.12.0" # Must be upgraded together with github actions
isort = "5.11.4" # Must be upgraded together with github actions
pre-commit = "^2.11.1"
termcolor = "^2.2.0"
coverage = {extras = ["toml"], version = "^7.0.5"}
pytest-cov = "^4.0.0"
pylint = "^2.8.2"
rope = "^1.7.0"
devtools="^0.10.0"
docker = "^6.0.1"
tqdm = "^4.62.3"
SQLAlchemy = "~1.3.0"
statsmodels = "^0.13.2" # Must be updated together with monetdb Dockerfile
psutil = "^5.9.0"
pytest-subtests = "^0.9.0"
mipdb = "1.0.1"  # Must be updated together with mipdb Dockerfile


[tool.pytest.ini_options]
markers = [
    "database: these tests depend on an external dockerized MonetDB service running (deselect with '-m \"not database\"')",
    "slow: marks tests as slow, mostly integration tests (deselect with '-m \"not slow\"')",
    "very_slow: marks tests as very_slow, integration tests with temporary container dependencies (deselect with '-m \"not very_slow\"')",
    "smpc: marks the tests validating smpc functionality (deselect with '-m \"not smpc\"')",
    "smpc_cluster: marks the tests that need smpc cluster deployment (deselect with '-m \"not smpc_cluster\"')",
]
filterwarnings = ["ignore::DeprecationWarning"]
norecursedirs = ["tests/testcase_generators"]

[tool.coverage.run]
source_pkgs = ['mipengine']
dynamic_context = 'test_function'

[tool.coverage.report]
exclude_lines = ['def __repr__', 'raise NotImplementedError', 'pragma: no cover']
show_missing = true

[tool.coverage.html]
show_contexts = true

[build-system]
requires = ["poetry-core=1.0.3"]
build-backend = "poetry.core.masonry.api"
